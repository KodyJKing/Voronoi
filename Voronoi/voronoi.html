<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
    </head>
    <body>
        <canvas id="myCanvas" width=500 height=500></canvas>
        <script src="voronoi.js"></script>
        <script>
            let canvas = document.getElementById("myCanvas")
            let ctx = canvas.getContext("2d")

            let voroPolys = []
            canvas.onmousedown = function(e) {
                let newPoint = new Vector(e.x, e.y)
                voroPolys.push(new VoroPoly(newPoint))
                voroPolys.forEach(poly => {
                    for (let i = 0; i < voroPolys.length; i++) {
                        poly.update(voroPolys[i].point)
                    }
                })
                render()
            }
            // window.onmousemove = function(e) {
            //     let newPoint = new Vector(e.x, e.y)
            //     points[0] = newPoint
            //     render()
            // }
            //RENDER FUNCTION
            function render() {
                let polyCount = voroPolys.length
                let lineCount = voroPolys.map(poly => poly.lines.length).reduce((a, b) => a + b, 0)
                console.log({polyCount, lineCount})
                //clear
                ctx.fillStyle = "hsl(236, 100%, 90%)"
                ctx.fillRect(0, 0, canvas.width, canvas.height)
                // generation items
                for (let voro of voroPolys) {
                    drawVoroPoly("black", voro)
                }
            }
            // render functions
            function drawLine(a, b) {
                ctx.beginPath()
                ctx.moveTo(a.x, a.y)
                ctx.lineTo(b.x, b.y)
                ctx.strokeWidth = 5
                ctx.stroke()
            }
            function drawCircle(color, a) {
                ctx.fillStyle = color
                ctx.beginPath()
                ctx.arc(a.x, a.y, 5, 0, 2 * Math.PI)
                ctx.fill()
            }
            function drawVoroPoly(color, voroPoly) {
                drawCircle("black", voroPoly.point)
                ctx.beginPath()
                for (let line of voroPoly.lines) {
                    ctx.moveTo(line.a.x, line.a.y)
                    ctx.lineTo(line.b.x, line.b.y)
                    ctx.stroke()
                }
            }
            render()
        </script>
    </body>
</html>